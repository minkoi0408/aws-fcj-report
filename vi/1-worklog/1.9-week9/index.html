<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../../images/favicon.png type=image/png><title>Worklog Tuần 9 :: Báo cáo thực tập</title>
<link href=../../../css/nucleus.css?1765204245 rel=stylesheet><link href=../../../css/fontawesome-all.min.css?1765204245 rel=stylesheet><link href=../../../css/hybrid.css?1765204245 rel=stylesheet><link href=../../../css/featherlight.min.css?1765204245 rel=stylesheet><link href=../../../css/perfect-scrollbar.min.css?1765204245 rel=stylesheet><link href=../../../css/auto-complete.css?1765204245 rel=stylesheet><link href=../../../css/atom-one-dark-reasonable.css?1765204245 rel=stylesheet><link href=../../../css/theme.css?1765204245 rel=stylesheet><link href=../../../css/hugo-theme.css?1765204245 rel=stylesheet><link href=../../../css/theme-workshop.css?1765204245 rel=stylesheet><script src=../../../js/jquery-3.3.1.min.js?1765204245></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../../vi/1-worklog/1.9-week9/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../../js/lunr.min.js?1765204245></script><script type=text/javascript src=../../../js/auto-complete.js?1765204245></script><script type=text/javascript>var baseurl="https://workshop-sample.fcjuni.com//vi"</script><script type=text/javascript src=../../../js/search.js?1765204245></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class="dd-item
parent"><a href=../../../vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Worklog Tuần 1" class=dd-item><a href=../../../vi/1-worklog/1.1-week1/><b>1.1. </b>Worklog Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Worklog Tuần 6" class=dd-item><a href=../../../vi/1-worklog/1.6-week6/><b>1.6. </b>Worklog Tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Worklog Tuần 7" class=dd-item><a href=../../../vi/1-worklog/1.7-week7/><b>1.7. </b>Worklog Tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Worklog Tuần 9" class="dd-item
active"><a href=../../../vi/1-worklog/1.9-week9/><b>1.9. </b>Worklog Tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Worklog Tuần 10" class=dd-item><a href=../../../vi/1-worklog/1.10-week10/><b>1.10. </b>Worklog Tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Worklog Tuần 11" class=dd-item><a href=../../../vi/1-worklog/1.11-week11/><b>1.11. </b>Worklog Tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Worklog Tuần 12" class=dd-item><a href=../../../vi/1-worklog/1.12-week12/><b>1.12 </b>Worklog Tuần 12
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Worklog Tuần 2" class=dd-item><a href=../../../vi/1-worklog/1.2-week2/><b>1.2. </b>Worklog Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Worklog Tuần 3" class=dd-item><a href=../../../vi/1-worklog/1.3-week3/><b>1.3. </b>Worklog Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Worklog Tuần 4" class=dd-item><a href=../../../vi/1-worklog/1.4-week4/><b>1.4. </b>Worklog Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Worklog Tuần 5" class=dd-item><a href=../../../vi/1-worklog/1.5-week5/><b>1.5. </b>Worklog Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Worklog Tuần 8" class=dd-item><a href=../../../vi/1-worklog/1.8-week8/><b>1.8. </b>Worklog Tuần 8
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title="Bản đề xuất" class=dd-item><a href=../../../vi/2-proposal/><b>2. </b>Bản đề xuất
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/ title="Các Blog Đã Dịch" class=dd-item><a href=../../../vi/3-blogstranslated/><b>3. </b>Các Blog Đã Dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Blog 1: Phát triển Data Lake Y tế với Microservices" class=dd-item><a href=../../../vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1: Phát triển Data Lake Y tế với Microservices
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2: Phân tích Log và Xây dựng Allowlist cho DNS Firewall" class=dd-item><a href=../../../vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2: Phân tích Log và Xây dựng Allowlist cho DNS Firewall
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="Blog 3: Phát hiện Lưu lượng Truy cập Bất thường bằng CloudWatch Alarms và Lambda" class=dd-item><a href=../../../vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3: Phát hiện Lưu lượng Truy cập Bất thường bằng CloudWatch Alarms và Lambda
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-eventparticipated/ title="Các events đã tham gia" class=dd-item><a href=../../../vi/4-eventparticipated/><b>4. </b>Các events đã tham gia
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="Event 1: Vietnam Cloud Day 2025 - Keynote Address" class=dd-item><a href=../../../vi/4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1: Vietnam Cloud Day 2025 - Keynote Address
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Event 2: Vietnam Cloud Day 2025 - Track for Builders" class=dd-item><a href=../../../vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2: Vietnam Cloud Day 2025 - Track for Builders
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.3-event3/ title="Event 3: AWS Cloud Mastery Series #1 - AI/ML/GenAI on AWS" class=dd-item><a href=../../../vi/4-eventparticipated/4.3-event3/><b>4.3. </b>Event 3: AWS Cloud Mastery Series #1 - AI/ML/GenAI on AWS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.4-event4/ title="Event 4: AWS Cloud Mastery Series #2 - DevOps on AWS" class=dd-item><a href=../../../vi/4-eventparticipated/4.4-event4/><b>4.4. </b>Event 4: AWS Cloud Mastery Series #2 - DevOps on AWS
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title=Workshop class=dd-item><a href=../../../vi/5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-workshop-overview/ title="Tổng quan Workshop" class=dd-item><a href=../../../vi/5-workshop/5.1-workshop-overview/><b>5.1. </b>Tổng quan Workshop
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-prerequiste/ title="Các bước chuẩn bị" class=dd-item><a href=../../../vi/5-workshop/5.2-prerequiste/><b>5.2. </b>Các bước chuẩn bị
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-s3-vpc/ title="Truy cập S3 từ VPC" class=dd-item><a href=../../../vi/5-workshop/5.3-s3-vpc/><b>5.3. </b>Truy cập S3 từ VPC
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.3-s3-vpc/5.3.1-create-gwe/ title="Tạo Gateway Endpoint cho S3" class=dd-item><a href=../../../vi/5-workshop/5.3-s3-vpc/5.3.1-create-gwe/><b>5.3.1 </b>Tạo Gateway Endpoint cho S3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-s3-vpc/5.3.2-test-gwe/ title="Kiểm Tra Kết Nối Gateway Endpoint" class=dd-item><a href=../../../vi/5-workshop/5.3-s3-vpc/5.3.2-test-gwe/><b>5.3.2 </b>Kiểm Tra Kết Nối Gateway Endpoint
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.4-s3-onprem/ title="Truy cập S3 từ môi trường truyền thống" class=dd-item><a href=../../../vi/5-workshop/5.4-s3-onprem/><b>5.4. </b>Truy cập S3 từ môi trường truyền thống
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.4-s3-onprem/5.4.1-prepare/ title="Chuẩn Bị Môi Trường cho Kết Nối Hybrid" class=dd-item><a href=../../../vi/5-workshop/5.4-s3-onprem/5.4.1-prepare/><b>5.4.1 </b>Chuẩn Bị Môi Trường cho Kết Nối Hybrid
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/ title="Tạo Interface VPC Endpoint cho Truy Cập S3" class=dd-item><a href=../../../vi/5-workshop/5.4-s3-onprem/5.4.2-create-interface-enpoint/><b>5.4.2 </b>Tạo Interface VPC Endpoint cho Truy Cập S3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/ title="Kiểm Tra Kết Nối Interface Endpoint từ On-Premises" class=dd-item><a href=../../../vi/5-workshop/5.4-s3-onprem/5.4.3-test-endpoint/><b>5.4.3 </b>Kiểm Tra Kết Nối Interface Endpoint từ On-Premises
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/ title="Cấu Hình Hybrid DNS cho Private Endpoint Resolution" class=dd-item><a href=../../../vi/5-workshop/5.4-s3-onprem/5.4.4-dns-simulation/><b>5.4.4 </b>Cấu Hình Hybrid DNS cho Private Endpoint Resolution
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.5-policy/ title="VPC Endpoint Policies" class=dd-item><a href=../../../vi/5-workshop/5.5-policy/><b>5.5 </b>VPC Endpoint Policies
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.6-cleanup/ title="Dọn dẹp tài nguyên" class=dd-item><a href=../../../vi/5-workshop/5.6-cleanup/><b>5.6. </b>Dọn dẹp tài nguyên
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự Đánh Giá" class=dd-item><a href=../../../vi/6-self-evaluation/><b>6. </b>Tự Đánh Giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia sẻ, đóng góp ý kiến" class=dd-item><a href=../../../vi/7-feedback/><b>7. </b>Chia sẻ, đóng góp ý kiến
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://workshop-sample.fcjuni.com/1-worklog/1.9-week9/>English</option><option id=vi value=https://workshop-sample.fcjuni.com/vi/1-worklog/1.9-week9/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../../vi/>Báo cáo thực tập</a> > <a href=../../../vi/1-worklog/>Nhật ký công việc</a> > Worklog Tuần 9</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#mục-tiêu-tuần-9>Mục tiêu tuần 9:</a></li><li><a href=#các-công-việc-cần-triển-khai-trong-tuần-này>Các công việc cần triển khai trong tuần này:</a></li><li><a href=#kết-quả-đạt-được-tuần-9>Kết quả đạt được tuần 9:</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Worklog Tuần 9</h1><h3 id=mục-tiêu-tuần-9>Mục tiêu tuần 9:</h3><ul><li>Làm chủ hệ sinh thái AWS Data & Analytics services và các mô hình kiến trúc dữ liệu hiện đại</li><li>Thiết kế và triển khai Data Lake cấp doanh nghiệp với governance và security</li><li>Xây dựng ETL/ELT pipelines toàn diện sử dụng AWS Glue và data transformation workflows</li><li>Triển khai real-time và batch analytics sử dụng Amazon Athena và advanced SQL</li><li>Tạo interactive BI dashboards với Amazon QuickSight và embedded analytics</li><li>Triển khai data cataloging, lineage tracking, và metadata management</li><li>Deploy streaming analytics với Amazon Kinesis và real-time data processing</li></ul><h3 id=các-công-việc-cần-triển-khai-trong-tuần-này>Các công việc cần triển khai trong tuần này:</h3><table><thead><tr><th style=text-align:left>Thứ</th><th style=text-align:left>Công việc</th><th style=text-align:left>Ngày bắt đầu</th><th style=text-align:left>Ngày hoàn thành</th><th style=text-align:left>Nguồn tài liệu</th></tr></thead><tbody><tr><td style=text-align:left>2</td><td style=text-align:left>- Giới thiệu về hệ sinh thái Data & Analytics trên AWS<br>- Hiểu khái niệm Data Lake, ETL pipeline và cách kết nối dữ liệu từ nhiều nguồn</td><td style=text-align:left>03/11/2025</td><td style=text-align:left>03/11/2025</td><td style=text-align:left>AWS Journey</td></tr><tr><td style=text-align:left>3</td><td style=text-align:left>- Tạo Data Lake trên Amazon S3<br>- Cấu trúc thư mục, quyền truy cập<br>- Thiết lập AWS Glue Crawler để nhận diện schema dữ liệu</td><td style=text-align:left>04/11/2025</td><td style=text-align:left>04/11/2025</td><td style=text-align:left>AWS Journey</td></tr><tr><td style=text-align:left>4</td><td style=text-align:left>- Thực hành AWS Athena để query dữ liệu trong Data Lake<br>- Viết các SQL query cơ bản và xuất kết quả ra S3</td><td style=text-align:left>05/11/2025</td><td style=text-align:left>05/11/2025</td><td style=text-align:left>AWS Journey</td></tr><tr><td style=text-align:left>5</td><td style=text-align:left>- Giới thiệu và thực hành với Amazon QuickSight<br>- Kết nối QuickSight với Athena để visualize dữ liệu<br>- Tạo dashboard đơn giản với biểu đồ và bảng tổng hợp</td><td style=text-align:left>06/11/2025</td><td style=text-align:left>06/11/2025</td><td style=text-align:left>AWS Journey</td></tr><tr><td style=text-align:left>6</td><td style=text-align:left>- Ôn tập & tổng kết kiến thức tuần:<br>+ Quy trình thu thập → xử lý → phân tích dữ liệu trên AWS<br>+ So sánh Glue, Athena, QuickSight với các công cụ truyền thống<br>+ Viết báo cáo tổng kết quá trình thực hành</td><td style=text-align:left>07/11/2025</td><td style=text-align:left>07/11/2025</td><td style=text-align:left>AWS Journey</td></tr></tbody></table><h3 id=kết-quả-đạt-được-tuần-9>Kết quả đạt được tuần 9:</h3><h4 id=1-thiết-kế-kiến-trúc-dữ-liệu-hiện-đại>1. Thiết kế Kiến trúc Dữ liệu Hiện đại</h4><ul><li><p><strong>Triển khai Medallion Architecture:</strong></p><ul><li><p><strong>Bronze Layer (Raw Zone):</strong></p><ul><li>Mục đích: Ingest raw data từ nhiều nguồn khác nhau mà không transformation</li><li>S3 bucket: <code>s3://datalake-bronze-prod/</code></li><li>Data formats: CSV, JSON, XML, Parquet, Avro</li><li>Retention: 90 ngày (lifecycle policy sang Glacier sau 30 ngày)</li><li>Encryption: SSE-KMS với customer-managed key</li><li>Versioning: Enabled cho data recovery</li><li>Data sources được ingest:<ul><li>Application logs (JSON) - 2.5 GB/ngày</li><li>Database CDC (Change Data Capture) - 800 MB/ngày</li><li>Third-party APIs (JSON/XML) - 350 MB/ngày</li><li>File uploads (CSV) - 1.2 GB/ngày</li><li>IoT sensor data (Parquet) - 4.8 GB/ngày</li></ul></li></ul></li><li><p><strong>Silver Layer (Cleansed/Conformed Zone):</strong></p><ul><li>Mục đích: Cleaned, validated, và standardized data</li><li>S3 bucket: <code>s3://datalake-silver-prod/</code></li><li>Data format: Parquet với Snappy compression</li><li>Partitioning: year/month/day/hour</li><li>Retention: 1 năm (hot), 3 năm (cold)</li><li>Data quality checks:<ul><li>Null value validation</li><li>Data type consistency</li><li>Business rule validation</li><li>Duplicate detection and removal</li><li>Schema evolution handling</li></ul></li><li>Transformation đã áp dụng:<ul><li>Data cleansing (trim, standardize formats)</li><li>Data enrichment (lookup, join reference data)</li><li>Data deduplication</li><li>PII masking cho sensitive fields</li></ul></li></ul></li><li><p><strong>Gold Layer (Curated/Business Zone):</strong></p><ul><li>Mục đích: Aggregated, business-ready datasets</li><li>S3 bucket: <code>s3://datalake-gold-prod/</code></li><li>Data format: Optimized Parquet với dictionary encoding</li><li>Partitioning: Optimized cho query patterns</li><li>Retention: 5 năm (compliance requirement)</li><li>Data marts đã tạo:<ul><li>Sales analytics mart</li><li>Customer 360 mart</li><li>Product performance mart</li><li>Operational metrics mart</li><li>Financial reporting mart</li></ul></li><li>SLA: Data available trong vòng 15 phút từ source update</li></ul></li></ul></li><li><p><strong>Sơ đồ Kiến trúc Dữ liệu:</strong></p><pre tabindex=0><code>Data Sources
    ↓
┌─────────────────────────────────────────┐
│  Ingestion Layer                        │
│  - Kinesis Data Streams (real-time)     │
│  - AWS DMS (database CDC)               │
│  - API Gateway + Lambda (APIs)          │
│  - S3 Transfer (batch files)            │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│  Bronze Layer (Raw Zone)                │
│  S3: Raw data, all formats              │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│  Processing Layer                       │
│  - AWS Glue ETL Jobs                    │
│  - Glue Data Quality                    │
│  - EMR for complex transformations      │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│  Silver Layer (Cleansed Zone)           │
│  S3: Parquet, validated, standardized   │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│  Aggregation Layer                      │
│  - Glue ETL Jobs (aggregations)         │
│  - Athena CTAS queries                  │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│  Gold Layer (Business Zone)             │
│  S3: Optimized data marts               │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│  Consumption Layer                      │
│  - Amazon Athena (SQL analytics)        │
│  - QuickSight (BI dashboards)           │
│  - SageMaker (ML models)                │
│  - Redshift Spectrum (DW integration)   │
└─────────────────────────────────────────┘
</code></pre></li><li><p><strong>Data Governance với AWS Lake Formation:</strong></p><ul><li><p><strong>Access Control:</strong></p><ul><li>Centralized permissions management</li><li>Column-level security cho PII fields</li><li>Row-level security dựa trên user attributes</li><li>Tag-based access control (TBAC)</li><li>Cross-account sharing với AWS RAM</li></ul></li><li><p><strong>Permissions Matrix:</strong></p><table><thead><tr><th style=text-align:left>Role</th><th style=text-align:left>Bronze</th><th style=text-align:left>Silver</th><th style=text-align:left>Gold</th><th style=text-align:left>PII Columns</th></tr></thead><tbody><tr><td style=text-align:left>Data Engineers</td><td style=text-align:left>Read/Write</td><td style=text-align:left>Read/Write</td><td style=text-align:left>Read/Write</td><td style=text-align:left>Masked</td></tr><tr><td style=text-align:left>Data Analysts</td><td style=text-align:left>Read</td><td style=text-align:left>Read</td><td style=text-align:left>Read</td><td style=text-align:left>Masked</td></tr><tr><td style=text-align:left>Data Scientists</td><td style=text-align:left>Read</td><td style=text-align:left>Read</td><td style=text-align:left>Read</td><td style=text-align:left>Masked</td></tr><tr><td style=text-align:left>Business Users</td><td style=text-align:left>No Access</td><td style=text-align:left>No Access</td><td style=text-align:left>Read</td><td style=text-align:left>Denied</td></tr><tr><td style=text-align:left>Compliance Team</td><td style=text-align:left>Read</td><td style=text-align:left>Read</td><td style=text-align:left>Read</td><td style=text-align:left>Unmasked</td></tr></tbody></table></li><li><p><strong>Data Catalog:</strong></p><ul><li>347 tables cataloged</li><li>1,245 columns documented</li><li>89 data sources registered</li><li>Schema versioning enabled</li><li>Automated metadata extraction</li></ul></li></ul></li></ul><h4 id=2-triển-khai-enterprise-data-lake>2. Triển khai Enterprise Data Lake</h4><ul><li><strong>Cấu hình S3 Data Lake:</strong><ul><li><p><strong>Cấu trúc Bucket:</strong></p><pre tabindex=0><code>datalake-bronze-prod/
├── application-logs/
│   └── year=2026/month=01/day=27/
├── database-cdc/
│   └── source=postgresql/table=orders/
├── api-data/
│   └── provider=stripe/endpoint=payments/
├── file-uploads/
│   └── type=customer-data/
└── iot-sensors/
    └── device-type=temperature/location=warehouse-1/

datalake-silver-prod/
├── customers/
│   └── year=2026/month=01/day=27/
├── orders/
│   └── year=2026/month=01/day=27/
├── products/
│   └── year=2026/month=01/
└── transactions/
    └── year=2026/month=01/day=27/hour=10/

datalake-gold-prod/
├── sales-analytics/
│   └── report-date=2026-01-27/
├── customer-360/
│   └── snapshot-date=2026-01-27/
└── product-performance/
    └── analysis-period=2026-01/
</code></pre></li><li><p><strong>Cấu hình Security:</strong></p><ul><li>Bucket encryption: SSE-KMS với automatic key rotation</li><li>Versioning: Enabled trên tất cả buckets</li><li>MFA Delete: Enabled cho production buckets</li><li>Access logging: Enabled to audit bucket</li><li>Object Lock: Enabled cho compliance data (WORM)</li><li>Block public access: Enforced ở bucket và account level</li><li>VPC Endpoints: S3 access through private network only</li></ul></li><li><p><strong>Cost Optimization:</strong></p><ul><li>S3 Intelligent-Tiering: Automatic tiering cho Bronze layer</li><li>Lifecycle policies:<ul><li>Bronze: 30 ngày Standard → Glacier Instant Retrieval</li><li>Silver: 90 ngày Standard → Glacier Flexible Retrieval</li><li>Gold: 365 ngày Standard → Glacier Deep Archive</li></ul></li><li>Compression: Parquet với Snappy (70% size reduction)</li><li>Partitioning: Giảm scan costs 85%</li><li>S3 Select: Push-down filtering (60% cost reduction)</li><li>Storage costs: $450/tháng cho 8.5 TB (giảm từ $1,200 với Standard storage)</li></ul></li><li><p><strong>Data Quality Metrics:</strong></p><ul><li>Data freshness: 99.2% trong SLA (15 phút)</li><li>Data completeness: 98.7% (missing field validation)</li><li>Data accuracy: 99.5% (business rule validation)</li><li>Schema compliance: 100% (automated checks)</li><li>Duplicate rate: 0.3% (post-deduplication)</li></ul></li></ul></li></ul><h4 id=3-triển-khai-aws-glue-etl-pipeline>3. Triển khai AWS Glue ETL Pipeline</h4><ul><li><p><strong>Cấu hình Glue Crawlers:</strong></p><ul><li><p><strong>Bronze Crawler:</strong></p><ul><li>Name: <code>bronze-data-crawler</code></li><li>Schedule: Mỗi 6 giờ</li><li>Data sources: Tất cả Bronze layer S3 paths</li><li>Classifiers: JSON, CSV, Parquet, Avro custom classifiers</li><li>Tables created: 45 tables</li><li>Partitions discovered: 2,834 partitions</li><li>Schema inference: Automatic với conflict resolution</li></ul></li><li><p><strong>Silver Crawler:</strong></p><ul><li>Name: <code>silver-data-crawler</code></li><li>Schedule: Daily lúc 2 AM</li><li>Data sources: Silver layer S3 paths</li><li>Partition projection: Enabled cho time-based partitions</li><li>Tables created: 28 tables</li><li>Schema evolution: Track và version changes</li></ul></li></ul></li><li><p><strong>Glue ETL Jobs:</strong></p><p><strong>Job 1 - Bronze to Silver Transformation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> awsglue.transforms <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> awsglue.utils <span style=color:#f92672>import</span> getResolvedOptions
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.context <span style=color:#f92672>import</span> SparkContext
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> awsglue.context <span style=color:#f92672>import</span> GlueContext
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> awsglue.job <span style=color:#f92672>import</span> Job
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> awsglue.dynamicframe <span style=color:#f92672>import</span> DynamicFrame
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.sql.functions <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>args <span style=color:#f92672>=</span> getResolvedOptions(sys<span style=color:#f92672>.</span>argv, [<span style=color:#e6db74>&#39;JOB_NAME&#39;</span>, <span style=color:#e6db74>&#39;database_name&#39;</span>, <span style=color:#e6db74>&#39;table_name&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sc <span style=color:#f92672>=</span> SparkContext()
</span></span><span style=display:flex><span>glueContext <span style=color:#f92672>=</span> GlueContext(sc)
</span></span><span style=display:flex><span>spark <span style=color:#f92672>=</span> glueContext<span style=color:#f92672>.</span>spark_session
</span></span><span style=display:flex><span>job <span style=color:#f92672>=</span> Job(glueContext)
</span></span><span style=display:flex><span>job<span style=color:#f92672>.</span>init(args[<span style=color:#e6db74>&#39;JOB_NAME&#39;</span>], args)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Đọc từ Bronze layer</span>
</span></span><span style=display:flex><span>bronze_dyf <span style=color:#f92672>=</span> glueContext<span style=color:#f92672>.</span>create_dynamic_frame<span style=color:#f92672>.</span>from_catalog(
</span></span><span style=display:flex><span>    database<span style=color:#f92672>=</span>args[<span style=color:#e6db74>&#39;database_name&#39;</span>],
</span></span><span style=display:flex><span>    table_name<span style=color:#f92672>=</span>args[<span style=color:#e6db74>&#39;table_name&#39;</span>],
</span></span><span style=display:flex><span>    transformation_ctx<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bronze_dyf&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert to Spark DataFrame cho transformations</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> bronze_dyf<span style=color:#f92672>.</span>toDF()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Data Quality Checks</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>filter(col(<span style=color:#e6db74>&#34;order_id&#34;</span>)<span style=color:#f92672>.</span>isNotNull())  <span style=color:#75715e># Loại bỏ null order IDs</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>filter(col(<span style=color:#e6db74>&#34;order_amount&#34;</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)  <span style=color:#75715e># Chỉ valid amounts</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>dropDuplicates([<span style=color:#e6db74>&#34;order_id&#34;</span>])  <span style=color:#75715e># Deduplicate</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Data Transformations</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;order_date&#34;</span>, to_date(col(<span style=color:#e6db74>&#34;created_at&#34;</span>)))
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;order_amount&#34;</span>, col(<span style=color:#e6db74>&#34;order_amount&#34;</span>)<span style=color:#f92672>.</span>cast(<span style=color:#e6db74>&#34;decimal(10,2)&#34;</span>))
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;customer_email&#34;</span>, lower(trim(col(<span style=color:#e6db74>&#34;customer_email&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># PII Masking</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;customer_phone_masked&#34;</span>, 
</span></span><span style=display:flex><span>                   regexp_replace(col(<span style=color:#e6db74>&#34;customer_phone&#34;</span>), <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>d</span><span style=color:#e6db74>{4}</span><span style=color:#e6db74>$&#34;</span>, <span style=color:#e6db74>&#34;XXXX&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Thêm metadata columns</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;processing_timestamp&#34;</span>, current_timestamp())
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;data_source&#34;</span>, lit(<span style=color:#e6db74>&#34;order_system&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Thêm partitioning columns</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;year&#34;</span>, year(col(<span style=color:#e6db74>&#34;order_date&#34;</span>)))
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;month&#34;</span>, month(col(<span style=color:#e6db74>&#34;order_date&#34;</span>)))
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>withColumn(<span style=color:#e6db74>&#34;day&#34;</span>, dayofmonth(col(<span style=color:#e6db74>&#34;order_date&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Convert back to DynamicFrame</span>
</span></span><span style=display:flex><span>silver_dyf <span style=color:#f92672>=</span> DynamicFrame<span style=color:#f92672>.</span>fromDF(df, glueContext, <span style=color:#e6db74>&#34;silver_dyf&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write to Silver layer in Parquet format với partitioning</span>
</span></span><span style=display:flex><span>glueContext<span style=color:#f92672>.</span>write_dynamic_frame<span style=color:#f92672>.</span>from_options(
</span></span><span style=display:flex><span>    frame<span style=color:#f92672>=</span>silver_dyf,
</span></span><span style=display:flex><span>    connection_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s3&#34;</span>,
</span></span><span style=display:flex><span>    connection_options<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;path&#34;</span>: <span style=color:#e6db74>&#34;s3://datalake-silver-prod/orders/&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;partitionKeys&#34;</span>: [<span style=color:#e6db74>&#34;year&#34;</span>, <span style=color:#e6db74>&#34;month&#34;</span>, <span style=color:#e6db74>&#34;day&#34;</span>]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    format<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;parquet&#34;</span>,
</span></span><span style=display:flex><span>    format_options<span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;compression&#34;</span>: <span style=color:#e6db74>&#34;snappy&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    transformation_ctx<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;silver_write&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>job<span style=color:#f92672>.</span>commit()
</span></span></code></pre></div><p><strong>Job 2 - Silver to Gold Aggregation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Daily sales aggregation job</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.sql.functions <span style=color:#f92672>import</span> sum, count, avg, max, min
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pyspark.sql.window <span style=color:#f92672>import</span> Window
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Đọc từ Silver layer</span>
</span></span><span style=display:flex><span>orders_df <span style=color:#f92672>=</span> spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://datalake-silver-prod/orders/&#34;</span>)
</span></span><span style=display:flex><span>customers_df <span style=color:#f92672>=</span> spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://datalake-silver-prod/customers/&#34;</span>)
</span></span><span style=display:flex><span>products_df <span style=color:#f92672>=</span> spark<span style=color:#f92672>.</span>read<span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://datalake-silver-prod/products/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Join datasets</span>
</span></span><span style=display:flex><span>sales_df <span style=color:#f92672>=</span> orders_df \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>join(customers_df, <span style=color:#e6db74>&#34;customer_id&#34;</span>, <span style=color:#e6db74>&#34;left&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>join(products_df, <span style=color:#e6db74>&#34;product_id&#34;</span>, <span style=color:#e6db74>&#34;left&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Daily sales aggregation</span>
</span></span><span style=display:flex><span>daily_sales <span style=color:#f92672>=</span> sales_df<span style=color:#f92672>.</span>groupBy(<span style=color:#e6db74>&#34;order_date&#34;</span>, <span style=color:#e6db74>&#34;product_category&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>agg(
</span></span><span style=display:flex><span>        sum(<span style=color:#e6db74>&#34;order_amount&#34;</span>)<span style=color:#f92672>.</span>alias(<span style=color:#e6db74>&#34;total_revenue&#34;</span>),
</span></span><span style=display:flex><span>        count(<span style=color:#e6db74>&#34;order_id&#34;</span>)<span style=color:#f92672>.</span>alias(<span style=color:#e6db74>&#34;total_orders&#34;</span>),
</span></span><span style=display:flex><span>        avg(<span style=color:#e6db74>&#34;order_amount&#34;</span>)<span style=color:#f92672>.</span>alias(<span style=color:#e6db74>&#34;avg_order_value&#34;</span>),
</span></span><span style=display:flex><span>        countDistinct(<span style=color:#e6db74>&#34;customer_id&#34;</span>)<span style=color:#f92672>.</span>alias(<span style=color:#e6db74>&#34;unique_customers&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Tính running totals với window functions</span>
</span></span><span style=display:flex><span>window_spec <span style=color:#f92672>=</span> Window<span style=color:#f92672>.</span>partitionBy(<span style=color:#e6db74>&#34;product_category&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>orderBy(<span style=color:#e6db74>&#34;order_date&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>rowsBetween(Window<span style=color:#f92672>.</span>unboundedPreceding, Window<span style=color:#f92672>.</span>currentRow)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>daily_sales <span style=color:#f92672>=</span> daily_sales<span style=color:#f92672>.</span>withColumn(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;cumulative_revenue&#34;</span>,
</span></span><span style=display:flex><span>    sum(<span style=color:#e6db74>&#34;total_revenue&#34;</span>)<span style=color:#f92672>.</span>over(window_spec)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write to Gold layer</span>
</span></span><span style=display:flex><span>daily_sales<span style=color:#f92672>.</span>write \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>mode(<span style=color:#e6db74>&#34;overwrite&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>partitionBy(<span style=color:#e6db74>&#34;order_date&#34;</span>) \
</span></span><span style=display:flex><span>    <span style=color:#f92672>.</span>parquet(<span style=color:#e6db74>&#34;s3://datalake-gold-prod/sales-analytics/daily-sales/&#34;</span>)
</span></span></code></pre></div></li><li><p><strong>Glue Data Quality Rules:</strong></p><pre tabindex=0><code>Rules = [
    # Completeness checks
    ColumnExists &#34;order_id&#34;,
    ColumnExists &#34;customer_id&#34;,
    ColumnExists &#34;order_amount&#34;,

    # Uniqueness checks
    IsUnique &#34;order_id&#34;,

    # Validity checks
    ColumnValues &#34;order_amount&#34; &gt; 0,
    ColumnValues &#34;order_status&#34; in [&#34;pending&#34;, &#34;completed&#34;, &#34;cancelled&#34;],
    ColumnDataType &#34;order_date&#34; = &#34;date&#34;,

    # Consistency checks
    ColumnLength &#34;customer_email&#34; &lt;= 255,
    RowCount &gt; 0,

    # Custom rules
    CustomSql &#34;SELECT COUNT(*) FROM primary WHERE order_amount &gt; 100000&#34; = 0
]
</code></pre></li><li><p><strong>Glue Job Monitoring:</strong></p><ul><li>Job execution metrics tracked trong CloudWatch</li><li>Average job duration: 8 phút (processing 4.5GB data)</li><li>Success rate: 99.1%</li><li>Failed jobs: Auto-retry 3 lần với exponential backoff</li><li>Cost per job run: $0.65 (2 DPU cho 8 phút)</li><li>Jobs triggered: 124 executions tuần này</li><li>Data processed: 562 GB tổng</li></ul></li></ul><h4 id=4-advanced-analytics-với-amazon-athena>4. Advanced Analytics với Amazon Athena</h4><ul><li><p><strong>Cấu hình Athena Workgroup:</strong></p><ul><li><p><strong>Production Workgroup:</strong></p><ul><li>Data scanned limit: 10 TB mỗi tháng</li><li>Query timeout: 30 phút</li><li>Results encryption: SSE-KMS</li><li>Results location: <code>s3://athena-results-prod/</code></li><li>Results retention: 30 ngày</li><li>Engine version: Athena engine version 3</li><li>Cost allocation tags: Environment=Production, Team=Analytics</li></ul></li><li><p><strong>Development Workgroup:</strong></p><ul><li>Data scanned limit: 1 TB mỗi tháng</li><li>Query timeout: 10 phút</li><li>Enforce workgroup configuration</li><li>Query result reuse: 60 phút</li></ul></li></ul></li><li><p><strong>Ví dụ Advanced SQL Queries:</strong></p><p><strong>Query 1 - Customer Cohort Analysis:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>WITH</span> customer_cohorts <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    customer_id,
</span></span><span style=display:flex><span>    DATE_TRUNC(<span style=color:#e6db74>&#39;month&#39;</span>, <span style=color:#66d9ef>MIN</span>(order_date)) <span style=color:#66d9ef>AS</span> cohort_month,
</span></span><span style=display:flex><span>    DATE_TRUNC(<span style=color:#e6db74>&#39;month&#39;</span>, order_date) <span style=color:#66d9ef>AS</span> order_month,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SUM</span>(order_amount) <span style=color:#66d9ef>AS</span> revenue
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> gold_layer.orders
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span> order_date <span style=color:#f92672>&gt;=</span> DATE <span style=color:#e6db74>&#39;2025-01-01&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>cohort_metrics <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    cohort_month,
</span></span><span style=display:flex><span>    order_month,
</span></span><span style=display:flex><span>    DATE_DIFF(<span style=color:#e6db74>&#39;month&#39;</span>, cohort_month, order_month) <span style=color:#66d9ef>AS</span> months_since_first_order,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>COUNT</span>(<span style=color:#66d9ef>DISTINCT</span> customer_id) <span style=color:#66d9ef>AS</span> customers,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SUM</span>(revenue) <span style=color:#66d9ef>AS</span> total_revenue
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> customer_cohorts
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>  cohort_month,
</span></span><span style=display:flex><span>  months_since_first_order,
</span></span><span style=display:flex><span>  customers,
</span></span><span style=display:flex><span>  total_revenue,
</span></span><span style=display:flex><span>  ROUND(<span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>*</span> customers <span style=color:#f92672>/</span> FIRST_VALUE(customers) 
</span></span><span style=display:flex><span>    OVER (PARTITION <span style=color:#66d9ef>BY</span> cohort_month <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> months_since_first_order), <span style=color:#ae81ff>2</span>) 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AS</span> retention_rate
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> cohort_metrics
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> cohort_month, months_since_first_order;
</span></span></code></pre></div><p><strong>Query 2 - Product Affinity Analysis:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>WITH</span> product_pairs <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    o1.order_id,
</span></span><span style=display:flex><span>    o1.product_id <span style=color:#66d9ef>AS</span> product_a,
</span></span><span style=display:flex><span>    o2.product_id <span style=color:#66d9ef>AS</span> product_b
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> gold_layer.order_items o1
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>JOIN</span> gold_layer.order_items o2 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ON</span> o1.order_id <span style=color:#f92672>=</span> o2.order_id 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AND</span> o1.product_id <span style=color:#f92672>&lt;</span> o2.product_id
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>  pa.product_name <span style=color:#66d9ef>AS</span> product_a_name,
</span></span><span style=display:flex><span>  pb.product_name <span style=color:#66d9ef>AS</span> product_b_name,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>AS</span> frequency,
</span></span><span style=display:flex><span>  ROUND(<span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#f92672>/</span> (
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#66d9ef>DISTINCT</span> order_id) <span style=color:#66d9ef>FROM</span> gold_layer.order_items
</span></span><span style=display:flex><span>  ), <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>AS</span> support_percentage
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> product_pairs pp
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> gold_layer.products pa <span style=color:#66d9ef>ON</span> pp.product_a <span style=color:#f92672>=</span> pa.product_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> gold_layer.products pb <span style=color:#66d9ef>ON</span> pp.product_b <span style=color:#f92672>=</span> pb.product_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>HAVING</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> frequency <span style=color:#66d9ef>DESC</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>LIMIT</span> <span style=color:#ae81ff>20</span>;
</span></span></code></pre></div><p><strong>Query 3 - Time Series Forecasting Preparation:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>WITH</span> daily_metrics <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    order_date,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SUM</span>(order_amount) <span style=color:#66d9ef>AS</span> daily_revenue,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>COUNT</span>(<span style=color:#66d9ef>DISTINCT</span> order_id) <span style=color:#66d9ef>AS</span> daily_orders,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>COUNT</span>(<span style=color:#66d9ef>DISTINCT</span> customer_id) <span style=color:#66d9ef>AS</span> daily_customers,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AVG</span>(order_amount) <span style=color:#66d9ef>AS</span> avg_order_value
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> gold_layer.orders
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>WHERE</span> order_date <span style=color:#f92672>&gt;=</span> <span style=color:#66d9ef>CURRENT_DATE</span> <span style=color:#f92672>-</span> INTERVAL <span style=color:#e6db74>&#39;365&#39;</span> <span style=color:#66d9ef>DAY</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> order_date
</span></span><span style=display:flex><span>),
</span></span><span style=display:flex><span>moving_averages <span style=color:#66d9ef>AS</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>    order_date,
</span></span><span style=display:flex><span>    daily_revenue,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AVG</span>(daily_revenue) OVER (
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>ROWS</span> <span style=color:#66d9ef>BETWEEN</span> <span style=color:#ae81ff>6</span> PRECEDING <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>CURRENT</span> <span style=color:#66d9ef>ROW</span>
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>AS</span> ma_7day,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AVG</span>(daily_revenue) OVER (
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>ROWS</span> <span style=color:#66d9ef>BETWEEN</span> <span style=color:#ae81ff>29</span> PRECEDING <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>CURRENT</span> <span style=color:#66d9ef>ROW</span>
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>AS</span> ma_30day,
</span></span><span style=display:flex><span>    STDDEV(daily_revenue) OVER (
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>ROWS</span> <span style=color:#66d9ef>BETWEEN</span> <span style=color:#ae81ff>29</span> PRECEDING <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>CURRENT</span> <span style=color:#66d9ef>ROW</span>
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>AS</span> stddev_30day
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>FROM</span> daily_metrics
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>  order_date,
</span></span><span style=display:flex><span>  daily_revenue,
</span></span><span style=display:flex><span>  ma_7day,
</span></span><span style=display:flex><span>  ma_30day,
</span></span><span style=display:flex><span>  <span style=color:#75715e>-- Z-score cho anomaly detection
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  (daily_revenue <span style=color:#f92672>-</span> ma_30day) <span style=color:#f92672>/</span> <span style=color:#66d9ef>NULLIF</span>(stddev_30day, <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>AS</span> z_score,
</span></span><span style=display:flex><span>  <span style=color:#75715e>-- Day of week patterns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  day_of_week(order_date) <span style=color:#66d9ef>AS</span> day_of_week,
</span></span><span style=display:flex><span>  <span style=color:#75715e>-- Month of year seasonality
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>month</span>(order_date) <span style=color:#66d9ef>AS</span> month_num
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> moving_averages
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> order_date <span style=color:#66d9ef>DESC</span>;
</span></span></code></pre></div></li><li><p><strong>Query Performance Optimization:</strong></p><ul><li><strong>Partitioning strategy:</strong> Giảm scan 85%<ul><li>Before: 2.4 TB scanned per query</li><li>After: 360 GB scanned per query</li></ul></li><li><strong>Columnar format (Parquet):</strong> 70% compression ratio</li><li><strong>Partition projection:</strong> Loại bỏ Glue Catalog calls</li><li><strong>CTAS (Create Table As Select):</strong> Materialized frequent queries</li><li><strong>Bucketing:</strong> Optimized join performance</li><li><strong>Query result reuse:</strong> 60-phút caching</li><li>Average query cost: $0.18 (giảm từ $1.20)</li></ul></li><li><p><strong>Athena Federated Queries:</strong></p><ul><li>Connected data sources:<ul><li>RDS PostgreSQL (operational database)</li><li>DynamoDB (user sessions)</li><li>DocumentDB (product catalog)</li><li>On-premises MySQL (via Lambda connector)</li></ul></li><li>Cross-source analytics enabled</li><li>Query example: Join S3 data lake với live RDS data</li></ul></li></ul><h4 id=5-enterprise-bi-với-amazon-quicksight>5. Enterprise BI với Amazon QuickSight</h4><ul><li><p><strong>Cấu hình QuickSight:</strong></p><ul><li><strong>Edition:</strong> Enterprise (SAML SSO, row-level security, hourly refresh)</li><li><strong>Users:</strong> 45 authors, 150 readers</li><li><strong>SPICE capacity:</strong> 50 GB allocated</li><li><strong>Data sources connected:</strong><ul><li>Amazon Athena (primary)</li><li>Amazon S3 (direct query)</li><li>Amazon RDS PostgreSQL</li><li>Salesforce (via connector)</li><li>Google Analytics (via connector)</li></ul></li></ul></li><li><p><strong>Triển khai Dashboards:</strong></p><p><strong>Dashboard 1 - Executive KPI Dashboard:</strong></p><ul><li><strong>Metrics hiển thị:</strong><ul><li>Total Revenue (current vs previous period)</li><li>Active Customers (MoM growth %)</li><li>Average Order Value (trend)</li><li>Customer Lifetime Value</li><li>Churn Rate</li><li>Net Promoter Score (NPS)</li></ul></li><li><strong>Visualizations:</strong><ul><li>KPI cards với comparison indicators</li><li>Line charts cho trends</li><li>Gauge charts cho goal tracking</li><li>Heat map cho regional performance</li><li>Funnel chart cho conversion analysis</li></ul></li><li><strong>Interactivity:</strong><ul><li>Date range filters</li><li>Region/Category drill-downs</li><li>Export to PDF/Excel</li><li>Email subscriptions (daily/weekly)</li></ul></li><li><strong>Auto-refresh:</strong> Mỗi 1 giờ</li><li><strong>Users:</strong> C-level executives (15 users)</li></ul><p><strong>Dashboard 2 - Sales Analytics Dashboard:</strong></p><ul><li><strong>Analysis sections:</strong><ul><li>Sales theo product category (bar chart)</li><li>Geographic sales distribution (map)</li><li>Top 10 products theo revenue (table với sparklines)</li><li>Sales vs target (combo chart)</li><li>Customer segmentation (tree map)</li><li>Month-over-month comparison (line chart)</li></ul></li><li><strong>Calculated fields:</strong><pre tabindex=0><code>Revenue Growth % = 
  (sum({revenue}) - sumOver(sum({revenue}), [{period} ASC], 1, 1)) 
  / sumOver(sum({revenue}), [{period} ASC], 1, 1) * 100

YTD Revenue = 
  sumOver(sum({revenue}), 
    [{year}], 
    [{year} = ${current_year}], 
    PRE_AGG)

Customer Segment = 
  ifelse({lifetime_value} &gt; 10000, &#34;VIP&#34;,
    ifelse({lifetime_value} &gt; 5000, &#34;High Value&#34;,
      ifelse({lifetime_value} &gt; 1000, &#34;Medium Value&#34;, 
        &#34;Low Value&#34;)))
</code></pre></li><li><strong>Parameters:</strong><ul><li>Date range selector</li><li>Product category filter</li><li>Region multi-select</li><li>Minimum order value threshold</li></ul></li><li><strong>Row-Level Security:</strong><ul><li>Sales managers: Chỉ xem region của họ</li><li>Product managers: Chỉ xem category của họ</li><li>Analysts: Xem tất cả data</li></ul></li><li><strong>Users:</strong> Sales team (35 users)</li></ul><p><strong>Dashboard 3 - Real-Time Operations Dashboard:</strong></p><ul><li><strong>Live metrics (1-phút refresh):</strong><ul><li>Current active users</li><li>Transactions per minute</li><li>System error rate</li><li>API response times</li><li>Inventory alerts</li></ul></li><li><strong>Data source:</strong> Kinesis Data Streams → Athena live query</li><li><strong>Alerts đã cấu hình:</strong><ul><li>Error rate > 2% → Email + Slack notification</li><li>Response time > 2s → PagerDuty alert</li><li>Inventory below threshold → Email to ops team</li></ul></li><li><strong>Users:</strong> Operations team (12 users)</li></ul></li><li><p><strong>QuickSight ML Insights:</strong></p><ul><li><strong>Anomaly detection:</strong> Tự động phát hiện unusual patterns<ul><li>Detected 3 anomalies tuần này:<ol><li>Unexpected revenue spike (holiday promotion - expected)</li><li>Low traffic on Tuesday (system maintenance - known)</li><li>Product category shift (new product launch - explained)</li></ol></li></ul></li><li><strong>Forecasting:</strong> Revenue forecast cho next 30 ngày<ul><li>Predicted revenue: $1.2M ± $150K (confidence interval)</li><li>Accuracy on last month: 92%</li></ul></li><li><strong>Contribution analysis:</strong> Identify key drivers<ul><li>Top revenue drivers: Product category (45%), Region (30%), Customer segment (15%)</li></ul></li></ul></li><li><p><strong>Embedded Analytics:</strong></p><ul><li>QuickSight dashboards embedded trong internal web application</li><li>SSO integration với corporate IdP</li><li>Custom branding và white-labeling</li><li>API-based dashboard provisioning</li><li>Row-level security enforced</li><li>Usage: 2,500 dashboard views/tuần</li></ul></li></ul><h4 id=6-triển-khai-streaming-analytics>6. Triển khai Streaming Analytics</h4><ul><li><p><strong>Cấu hình Kinesis Data Streams:</strong></p><ul><li><strong>Stream:</strong> <code>clickstream-events</code></li><li><strong>Shards:</strong> 4 shards (4 MB/sec write, 8 MB/sec read capacity)</li><li><strong>Retention:</strong> 7 ngày</li><li><strong>Encryption:</strong> KMS encryption enabled</li><li><strong>Data producers:</strong><ul><li>Web application (user clicks, page views)</li><li>Mobile app (app events, user actions)</li><li>IoT devices (sensor readings)</li></ul></li><li><strong>Throughput:</strong> 3.2 MB/sec trung bình, 6.5 MB/sec peak</li><li><strong>Records/sec:</strong> 850 trung bình, 1,800 peak</li></ul></li><li><p><strong>Kinesis Data Firehose Delivery:</strong></p><ul><li><strong>Delivery streams đã tạo:</strong><ol><li><p><strong>S3 Delivery Stream:</strong></p><ul><li>Destination: <code>s3://datalake-bronze-prod/clickstream/</code></li><li>Buffer size: 5 MB</li><li>Buffer interval: 300 giây</li><li>Compression: Gzip</li><li>Format conversion: JSON to Parquet</li><li>Partitioning: year/month/day/hour</li><li>Data transformation: Lambda function cho enrichment</li></ul></li><li><p><strong>OpenSearch Delivery Stream:</strong></p><ul><li>Destination: OpenSearch domain <code>analytics-cluster</code></li><li>Index: <code>clickstream-{yyyy-MM-dd}</code></li><li>Buffer size: 5 MB</li><li>Buffer interval: 60 giây</li><li>Retry duration: 3600 giây</li><li>Use case: Real-time dashboards và search</li></ul></li></ol></li></ul></li><li><p><strong>Real-Time Processing với Lambda:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>lambda_handler</span>(event, context):
</span></span><span style=display:flex><span>    output <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> record <span style=color:#f92672>in</span> event[<span style=color:#e6db74>&#39;records&#39;</span>]:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Decode Kinesis data</span>
</span></span><span style=display:flex><span>        payload <span style=color:#f92672>=</span> base64<span style=color:#f92672>.</span>b64decode(record[<span style=color:#e6db74>&#39;data&#39;</span>])<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>loads(payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Enrich data</span>
</span></span><span style=display:flex><span>        data[<span style=color:#e6db74>&#39;processed_timestamp&#39;</span>] <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>utcnow()<span style=color:#f92672>.</span>isoformat()
</span></span><span style=display:flex><span>        data[<span style=color:#e6db74>&#39;partition_key&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>data[<span style=color:#e6db74>&#39;user_id&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>_</span><span style=color:#e6db74>{</span>data[<span style=color:#e6db74>&#39;session_id&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Classify user action</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;purchase&#39;</span> <span style=color:#f92672>in</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;event_type&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>):
</span></span><span style=display:flex><span>            data[<span style=color:#e6db74>&#39;event_category&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;conversion&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> <span style=color:#e6db74>&#39;add_to_cart&#39;</span> <span style=color:#f92672>in</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;event_type&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>):
</span></span><span style=display:flex><span>            data[<span style=color:#e6db74>&#39;event_category&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;engagement&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            data[<span style=color:#e6db74>&#39;event_category&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;browsing&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Calculate session duration</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;event_type&#39;</span>) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;session_end&#39;</span>:
</span></span><span style=display:flex><span>            session_duration <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;timestamp&#39;</span>) <span style=color:#f92672>-</span> data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;session_start_time&#39;</span>)
</span></span><span style=display:flex><span>            data[<span style=color:#e6db74>&#39;session_duration_sec&#39;</span>] <span style=color:#f92672>=</span> session_duration
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Encode back to base64</span>
</span></span><span style=display:flex><span>        output_record <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;recordId&#39;</span>: record[<span style=color:#e6db74>&#39;recordId&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;result&#39;</span>: <span style=color:#e6db74>&#39;Ok&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;data&#39;</span>: base64<span style=color:#f92672>.</span>b64encode(json<span style=color:#f92672>.</span>dumps(data)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        output<span style=color:#f92672>.</span>append(output_record)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#39;records&#39;</span>: output}
</span></span></code></pre></div></li><li><p><strong>Kinesis Data Analytics Application:</strong></p><ul><li><strong>Application type:</strong> SQL-based analytics</li><li><strong>Use case:</strong> Real-time aggregations và windowing</li><li><strong>Ví dụ SQL query:</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>REPLACE</span> STREAM <span style=color:#e6db74>&#34;DESTINATION_SQL_STREAM&#34;</span> (
</span></span><span style=display:flex><span>    window_start <span style=color:#66d9ef>TIMESTAMP</span>,
</span></span><span style=display:flex><span>    event_type VARCHAR(<span style=color:#ae81ff>50</span>),
</span></span><span style=display:flex><span>    event_count INTEGER,
</span></span><span style=display:flex><span>    unique_users INTEGER,
</span></span><span style=display:flex><span>    avg_session_duration DOUBLE
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>REPLACE</span> PUMP <span style=color:#e6db74>&#34;STREAM_PUMP&#34;</span> <span style=color:#66d9ef>AS</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> <span style=color:#e6db74>&#34;DESTINATION_SQL_STREAM&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> STREAM 
</span></span><span style=display:flex><span>    STEP(<span style=color:#e6db74>&#34;SOURCE_SQL_STREAM_001&#34;</span>.ROWTIME <span style=color:#66d9ef>BY</span> INTERVAL <span style=color:#e6db74>&#39;1&#39;</span> <span style=color:#66d9ef>MINUTE</span>) <span style=color:#66d9ef>AS</span> window_start,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;event_type&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>AS</span> event_count,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>COUNT</span>(<span style=color:#66d9ef>DISTINCT</span> <span style=color:#e6db74>&#34;user_id&#34;</span>) <span style=color:#66d9ef>AS</span> unique_users,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>AVG</span>(<span style=color:#e6db74>&#34;session_duration_sec&#34;</span>) <span style=color:#66d9ef>AS</span> avg_session_duration
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#e6db74>&#34;SOURCE_SQL_STREAM_001&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> 
</span></span><span style=display:flex><span>    STEP(<span style=color:#e6db74>&#34;SOURCE_SQL_STREAM_001&#34;</span>.ROWTIME <span style=color:#66d9ef>BY</span> INTERVAL <span style=color:#e6db74>&#39;1&#39;</span> <span style=color:#66d9ef>MINUTE</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;event_type&#34;</span>;
</span></span></code></pre></div></li><li><strong>Output:</strong> Gửi aggregated data to:<ul><li>Kinesis Data Streams (cho further processing)</li><li>Lambda (cho alerting)</li><li>OpenSearch (cho real-time dashboards)</li></ul></li></ul></li><li><p><strong>Streaming Analytics Metrics:</strong></p><ul><li>Events processed: 2.4M events/ngày</li><li>Average latency: 1.2 giây (ingestion to dashboard)</li><li>Processing cost: $85/ngày ($2,550/tháng)</li><li>Data volume: 3.8 GB/ngày compressed</li></ul></li></ul><h4 id=7-comprehensive-monitoring-và-operations>7. Comprehensive Monitoring và Operations</h4><ul><li><p><strong>CloudWatch Dashboards:</strong></p><ul><li><p><strong>Data Pipeline Health Dashboard:</strong></p><ul><li>Glue job success/failure rates</li><li>ETL job durations</li><li>Data quality check pass rates</li><li>S3 bucket storage growth</li><li>Athena query metrics</li><li>Kinesis stream throughput</li></ul></li><li><p><strong>Cost Monitoring Dashboard:</strong></p><ul><li>S3 storage costs theo layer</li><li>Glue job execution costs</li><li>Athena query costs theo workgroup</li><li>Kinesis streaming costs</li><li>QuickSight user costs</li><li>Daily cost breakdown</li></ul></li></ul></li><li><p><strong>CloudWatch Alarms:</strong></p><ul><li>Glue job failures → SNS → Email + Slack</li><li>Athena cost threshold exceeded → Budget alert</li><li>Kinesis stream throttling → Auto-scaling trigger</li><li>Data freshness SLA breach → PagerDuty</li><li>S3 storage > 10 TB → Cost review notification</li></ul></li><li><p><strong>Data Lineage và Metadata:</strong></p><ul><li>AWS Glue Data Catalog: Source of truth cho schemas</li><li>Table metadata: 347 tables documented</li><li>Column-level metadata: Data types, descriptions, PII tags</li><li>Lineage tracking: Source → Bronze → Silver → Gold</li><li>Impact analysis: Dashboards nào affected bởi schema changes</li></ul></li></ul><h4 id=8-tóm-tắt-week-9-và-key-metrics>8. Tóm tắt Week 9 và Key Metrics</h4><ul><li><p><strong>Data Platform Metrics:</strong></p><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left>Total data ingested</td><td style=text-align:left>42 GB/ngày</td></tr><tr><td style=text-align:left>Data sources</td><td style=text-align:left>12 sources</td></tr><tr><td style=text-align:left>Tables in catalog</td><td style=text-align:left>347 tables</td></tr><tr><td style=text-align:left>Glue jobs</td><td style=text-align:left>18 jobs</td></tr><tr><td style=text-align:left>Athena queries/ngày</td><td style=text-align:left>450 queries</td></tr><tr><td style=text-align:left>QuickSight dashboards</td><td style=text-align:left>15 dashboards</td></tr><tr><td style=text-align:left>QuickSight users</td><td style=text-align:left>195 users</td></tr><tr><td style=text-align:left>Dashboard views/tuần</td><td style=text-align:left>2,500 views</td></tr><tr><td style=text-align:left>Data freshness (avg)</td><td style=text-align:left>12 phút</td></tr><tr><td style=text-align:left>Query performance (p95)</td><td style=text-align:left>8 giây</td></tr><tr><td style=text-align:left>Monthly data platform cost</td><td style=text-align:left>$3,200</td></tr><tr><td style=text-align:left>Cost per GB processed</td><td style=text-align:left>$0.07</td></tr></tbody></table></li><li><p><strong>Business Value Delivered:</strong></p><ul><li>Giảm time-to-insight từ 2 ngày xuống 15 phút (99% improvement)</li><li>Self-service analytics: 85% reports tự generate bởi business users</li><li>Data democratization: 195 users có data access (tăng từ 12 analysts)</li><li>Cost savings: $8,500/tháng vs traditional DW solution</li><li>Decision speed: Real-time dashboards cho phép faster business decisions</li></ul></li><li><p><strong>Thành tựu Kỹ thuật:</strong></p><ul><li>Triển khai modern medallion architecture</li><li>100% serverless data platform (không infrastructure management)</li><li>Scalable từ GB đến PB (tested up to 500 GB/ngày)</li><li>Comprehensive data governance với Lake Formation</li><li>Real-time và batch analytics coexistence</li><li>Advanced ML insights integrated</li></ul></li><li><p><strong>Bài học Rút ra:</strong></p><ol><li><strong>Partitioning strategy là critical</strong> cho query performance và cost</li><li><strong>Parquet format</strong> giảm đáng kể storage và query costs</li><li><strong>Data quality checks</strong> nên implement sớm trong pipeline</li><li><strong>Incremental processing</strong> hiệu quả hơn full reprocessing</li><li><strong>SPICE trong QuickSight</strong> cung cấp fast dashboard performance</li><li><strong>Row-level security</strong> essential cho data governance</li><li><strong>Athena workgroups</strong> enable cost control và usage tracking</li><li><strong>Streaming và batch</strong> architectures bổ sung cho nhau</li></ol></li><li><p><strong>Bước tiếp theo:</strong></p><ul><li>Triển khai ML models với SageMaker sử dụng Gold layer data</li><li>Thêm data sources (social media, marketing platforms)</li><li>Triển khai data quality scorecards</li><li>Mở rộng QuickSight embedded analytics</li><li>Deploy DataZone cho data marketplace</li><li>Triển khai automated data cataloging với AI</li></ul></li></ul><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../../vi/1-worklog/1.7-week7/ title="Worklog Tuần 7"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../../vi/1-worklog/1.10-week10/ title="Worklog Tuần 10" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../../js/clipboard.min.js?1765204245></script><script src=../../../js/perfect-scrollbar.min.js?1765204245></script><script src=../../../js/perfect-scrollbar.jquery.min.js?1765204245></script><script src=../../../js/jquery.sticky.js?1765204245></script><script src=../../../js/featherlight.min.js?1765204245></script><script src=../../../js/highlight.pack.js?1765204245></script><script>hljs.initHighlightingOnLoad()</script><script src=../../../js/modernizr.custom-3.6.0.js?1765204245></script><script src=../../../js/learn.js?1765204245></script><script src=../../../js/hugo-learn.js?1765204245></script><link href=../../../mermaid/mermaid.css?1765204245 rel=stylesheet><script src=../../../mermaid/mermaid.js?1765204245></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>